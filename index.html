<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Opmeting ramen & deuren</title>

<style>
body {
  font-family: Arial, sans-serif;
  font-size: 18px;
  margin: 0;
  padding: 1rem;
  background: #f5f5f5;
}

header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
}

header img {
  height: 50px;
}

button {
  font-size: 18px;
  padding: 10px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

.btn-add {
  background: #2ecc71;
  color: white;
}

.element {
  background: white;
  padding: 1rem;
  border-radius: 10px;
  margin-bottom: 1rem;
}

.element-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: bold;
  margin-bottom: .5rem;
}

.remove-btn {
  background: red;
  color: white;
  width: 36px;
  height: 36px;
  border-radius: 6px;
  font-size: 22px;
}

.inputs {
  display: flex;
  gap: .5rem;
  margin-bottom: .5rem;
}

.inputs input, .inputs select {
  font-size: 18px;
  padding: .4rem;
  width: 100%;
}

.photos {
  display: flex;
  flex-wrap: wrap;
  gap: .5rem;
}

.photo-box {
  position: relative;
}

.photo-box img {
  width: 120px;
  border-radius: 8px;
}

.photo-box button {
  position: absolute;
  top: 4px;
  right: 4px;
  background: red;
  color: white;
  border-radius: 4px;
  width: 28px;
  height: 28px;
}

.camera-btn {
  font-size: 32px;
  background: #ddd;
  border-radius: 8px;
}
</style>
</head>

<body>

<header>
  <img src="Logordb.png">
  <h2>Opmeting</h2>
</header>

<button class="btn-add" onclick="addElement()">âž• Element toevoegen</button>

<div id="elements"></div>

<input type="file" id="cameraInput" accept="image/*" capture="environment" hidden>

<script>
let data = JSON.parse(localStorage.getItem("opmeting")) || [];

const elementsDiv = document.getElementById("elements");
const cameraInput = document.getElementById("cameraInput");

let activeElementIndex = null;

function save() {
  localStorage.setItem("opmeting", JSON.stringify(data));
}

function addElement(type = "Raam") {
  data.push({ type, breedte: "", hoogte: "", photos: [] });
  save();
  render();
  setTimeout(() => {
    elementsDiv.lastElementChild.scrollIntoView({ behavior: "smooth" });
  }, 100);
}

function removeElement(i) {
  data.splice(i, 1);
  save();
  render();
}

function openCamera(i) {
  activeElementIndex = i;
  cameraInput.click();
}

cameraInput.onchange = () => {
  const file = cameraInput.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = () => {
    data[activeElementIndex].photos.push(reader.result);
    save();
    render();
  };
  reader.readAsDataURL(file);
};

function removePhoto(elIndex, photoIndex) {
  data[elIndex].photos.splice(photoIndex, 1);
  save();
  render();
}

function render() {
  elementsDiv.innerHTML = "";

  const counters = { Raam: 0, Deur: 0, Poort: 0 };

  data.forEach((el, i) => {
    counters[el.type]++;
    const label = `${el.type} ${counters[el.type]}`;

    const div = document.createElement("div");
    div.className = "element";

    div.innerHTML = `
      <div class="element-header">
        ${label}
        <button class="remove-btn" onclick="removeElement(${i})">âœ–</button>
      </div>

      <div class="inputs">
        <select onchange="data[${i}].type=this.value; save(); render();">
          <option ${el.type==="Raam"?"selected":""}>Raam</option>
          <option ${el.type==="Deur"?"selected":""}>Deur</option>
          <option ${el.type==="Poort"?"selected":""}>Poort</option>
        </select>
        <input placeholder="Breedte (cm)" value="${el.breedte}"
          onchange="data[${i}].breedte=this.value; save();">
        <input placeholder="Hoogte (cm)" value="${el.hoogte}"
          onchange="data[${i}].hoogte=this.value; save();">
      </div>

      <div class="photos" id="photos-${i}"></div>

      <button class="camera-btn" onclick="openCamera(${i})">ðŸ“·</button>
    `;

    elementsDiv.appendChild(div);

    const photosDiv = div.querySelector(".photos");
    el.photos.forEach((p, pi) => {
      const box = document.createElement("div");
      box.className = "photo-box";
      box.innerHTML = `
        <img src="${p}">
        <button onclick="removePhoto(${i},${pi})">âœ–</button>
      `;
      photosDiv.appendChild(box);
    });
  });
}

render();
</script>

</body>
</html>


