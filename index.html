const cam = el.querySelector(".camera-btn");
const fileInput = el.querySelector(".file-input");
const photoContainer = el.querySelector(".photo-container");

cam.onclick = () => fileInput.click();

fileInput.onchange = () => {
  const f = fileInput.files[0];
  if(!f) return;

  const reader = new FileReader();
  reader.onload = e => {
    const imgObj = new Image();
    imgObj.onload = () => {
      const canvas = document.createElement("canvas");
      const maxWidth = 800;
      let scale = Math.min(1, maxWidth / imgObj.width);
      canvas.width = imgObj.width * scale;
      canvas.height = imgObj.height * scale;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(imgObj,0,0,canvas.width,canvas.height);

      const imgData = canvas.toDataURL("image/jpeg",0.6);

      const photoWrapper = document.createElement("div");
      photoWrapper.style.position = "relative";
      photoWrapper.style.marginTop = "10px";

      const imgEl = document.createElement("img");
      imgEl.src = imgData;

      const removeBtn = document.createElement("button");
      removeBtn.textContent = "âœ–";
      removeBtn.className = "remove-photo";
      removeBtn.onclick = () => photoWrapper.remove();

      photoWrapper.appendChild(imgEl);
      photoWrapper.appendChild(removeBtn);
      photoContainer.appendChild(photoWrapper);
    }
    imgObj.src = e.target.result;
  }
  reader.readAsDataURL(f);
};

